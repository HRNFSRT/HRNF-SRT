<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Viewer</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script type="module">
        // Import Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-storage.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCCz1kIH5hT_15pWT9rf5JqJhexK76qpRE",
            authDomain: "hrnf-srt.firebaseapp.com",
            projectId: "hrnf-srt",
            storageBucket: "hrnf-srt.appspot.com",
            messagingSenderId: "748926279394",
            appId: "1:748926279394:web:1303b9000361b1d51808bb",
            measurementId: "G-5PCZE3S5N5"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app); // Initialize Storage

        // Load PDF.js Worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        // Load PDF from Firebase and render with PDF.js
        async function loadPDF() {
            try {
                const pdfRef = ref(storage, 'HRNF S&R Handbook V2 (1).pdf'); // Reference to the PDF
                const url = await getDownloadURL(pdfRef); // Get the download URL for the PDF
                const pdf = await pdfjsLib.getDocument(url).promise; // Load PDF document
                renderPDF(pdf); // Render the PDF
            } catch (error) {
                console.error("Error loading PDF:", error);
            }
        }

        // Render the PDF using PDF.js
        async function renderPDF(pdf) {
            const pdfViewerContainer = document.getElementById('pdfViewerContainer');
            pdfViewerContainer.innerHTML = ''; // Clear the container before rendering

            for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
                const page = await pdf.getPage(pageNum);
                const viewport = page.getViewport({ scale: 1.5 });

                const canvas = document.createElement('canvas');
                canvas.className = 'pdf-page';
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;

                const renderContext = {
                    canvasContext: context,
                    viewport: viewport,
                };
                await page.render(renderContext);
                pdfViewerContainer.appendChild(canvas); // Append the canvas to the viewer
            }
        }

        // Function to scroll to sections in the PDF
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            } else {
                console.warn("Section not found:", sectionId);
            }
        }

        // Initialize everything when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            loadPDF(); // Load the PDF
        });

        // Add click event listener to toggle subheadings
        document.addEventListener('click', (event) => {
            const subheadingToggle = event.target.closest('.sidebar > ul > li > div');
            if (subheadingToggle) {
                const subheadings = subheadingToggle.nextElementSibling;
                if (subheadings) {
                    subheadings.classList.toggle('show');
                }
            }
        });
    </script>
</head>
<body>

<div class="container">
    <div class="sidebar">
        <h2>Table of Contents</h2>
        <ul>
            <li>
                <div>Who the HRNF Rescue Company are</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('whoHRNF')">Page 3</li>
                </ul>
            </li>
            <li>
                <div>Company Overview</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('companyOverview')">Page 4</li>
                </ul>
            </li>
            <li>
                <div>Standard HRNF Radio Guide</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('radioGuide')">Page 5</li>
                </ul>
            </li>
            <li>
                <div>Vehicle Guide</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('vehicleGuide')">Page 8</li>
                </ul>
            </li>
            <li>
                <div>Quick Reference Guide for Incident Response</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('quickReference')">Page 11</li>
                </ul>
            </li>
            <li>
                <div>GARC Supplements</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('garcSupplements')">Page 47</li>
                </ul>
            </li>
            <li>
                <div>Search Theory</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('searchTheory')">Part 1: Fundamentals of Search Theory</li>
                    <li onclick="scrollToSection('searchPlanning')">Part 2: Search Planning and Strategy</li>
                    <li onclick="scrollToSection('searchTechniques')">Part 3: Search Techniques</li>
                    <li onclick="scrollToSection('analyzingSearch')">Part 4: Analyzing and Adapting Search Efforts</li>
                </ul>
            </li>
            <li>
                <div>Off-Roading Guide</div>
                <ul class="subheadings">
                    <li onclick="scrollToSection('offRoadingGuide')">Page 58</li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="pdf-viewer-container" id="pdfViewerContainer">
        <!-- The PDF pages will be dynamically loaded here -->
    </div>
</div>

</body>
</html>
